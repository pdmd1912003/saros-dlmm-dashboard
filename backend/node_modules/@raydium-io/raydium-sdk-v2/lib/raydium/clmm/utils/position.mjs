var Tn=Object.defineProperty,xn=Object.defineProperties;var An=Object.getOwnPropertyDescriptors;var _t=Object.getOwnPropertySymbols;var Pn=Object.prototype.hasOwnProperty,kn=Object.prototype.propertyIsEnumerable;var Ft=(t,e,n)=>e in t?Tn(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,oe=(t,e)=>{for(var n in e||(e={}))Pn.call(e,n)&&Ft(t,n,e[n]);if(_t)for(var n of _t(e))kn.call(e,n)&&Ft(t,n,e[n]);return t},ce=(t,e)=>xn(t,An(e));import ae from"bn.js";var Pe=9e15,he=1e9,it="0123456789abcdef",Ue="2.3025850929940456840179914546843642076011014886287729760333279009675726096773524802359972050895982983419677840422862486334095254650828067566662873690987816894829072083255546808437998948262331985283935053089653777326288461633662222876982198867465436674744042432743651550489343149393914796194044002221051017141748003688084012647080685567743216228355220114804663715659121373450747856947683463616792101806445070648000277502684916746550586856935673420670581136429224554405758925724208241314695689016758940256776311356919292033376587141660230105703089634572075440370847469940168269282808481184289314848524948644871927809676271275775397027668605952496716674183485704422507197965004714951050492214776567636938662976979522110718264549734772662425709429322582798502585509785265383207606726317164309505995087807523710333101197857547331541421808427543863591778117054309827482385045648019095610299291824318237525357709750539565187697510374970888692180205189339507238539205144634197265287286965110862571492198849978748873771345686209167058",We="3.1415926535897932384626433832795028841971693993751058209749445923078164062862089986280348253421170679821480865132823066470938446095505822317253594081284811174502841027019385211055596446229489549303819644288109756659334461284756482337867831652712019091456485669234603486104543266482133936072602491412737245870066063155881748815209209628292540917153643678925903600113305305488204665213841469519415116094330572703657595919530921861173819326117931051185480744623799627495673518857527248912279381830119491298336733624406566430860213949463952247371907021798609437027705392171762931767523846748184676694051320005681271452635608277857713427577896091736371787214684409012249534301465495853710507922796892589235420199561121290219608640344181598136297747713099605187072113499999983729780499510597317328160963185950244594553469083026425223082533446850352619311881710100031378387528865875332083814206171776691473035982534904287554687311595628638823537875937519577818577805321712268066130019278766111959092164201989380952572010654858632789",ot={precision:20,rounding:4,modulo:1,toExpNeg:-7,toExpPos:21,minE:-Pe,maxE:Pe,crypto:!1},Ot,me,w=!0,He="[DecimalError] ",ge=He+"Invalid argument: ",Kt=He+"Precision limit exceeded",qt=He+"crypto unavailable",Gt="[object Decimal]",U=Math.floor,D=Math.pow,Bn=/^0b([01]+(\.[01]*)?|\.[01]+)(p[+-]?\d+)?$/i,In=/^0x([0-9a-f]+(\.[0-9a-f]*)?|\.[0-9a-f]+)(p[+-]?\d+)?$/i,Nn=/^0o([0-7]+(\.[0-7]*)?|\.[0-7]+)(p[+-]?\d+)?$/i,Vt=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,ne=1e7,b=7,Sn=9007199254740991,Cn=Ue.length-1,st=We.length-1,f={toStringTag:Gt};f.absoluteValue=f.abs=function(){var t=new this.constructor(this);return t.s<0&&(t.s=1),g(t)};f.ceil=function(){return g(new this.constructor(this),this.e+1,2)};f.clampedTo=f.clamp=function(t,e){var n,r=this,i=r.constructor;if(t=new i(t),e=new i(e),!t.s||!e.s)return new i(NaN);if(t.gt(e))throw Error(ge+e);return n=r.cmp(t),n<0?t:r.cmp(e)>0?e:new i(r)};f.comparedTo=f.cmp=function(t){var e,n,r,i,o=this,s=o.d,a=(t=new o.constructor(t)).d,c=o.s,u=t.s;if(!s||!a)return!c||!u?NaN:c!==u?c:s===a?0:!s^c<0?1:-1;if(!s[0]||!a[0])return s[0]?c:a[0]?-u:0;if(c!==u)return c;if(o.e!==t.e)return o.e>t.e^c<0?1:-1;for(r=s.length,i=a.length,e=0,n=r<i?r:i;e<n;++e)if(s[e]!==a[e])return s[e]>a[e]^c<0?1:-1;return r===i?0:r>i^c<0?1:-1};f.cosine=f.cos=function(){var t,e,n=this,r=n.constructor;return n.d?n.d[0]?(t=r.precision,e=r.rounding,r.precision=t+Math.max(n.e,n.sd())+b,r.rounding=1,n=Ln(r,zt(r,n)),r.precision=t,r.rounding=e,g(me==2||me==3?n.neg():n,t,e,!0)):new r(1):new r(NaN)};f.cubeRoot=f.cbrt=function(){var t,e,n,r,i,o,s,a,c,u,m=this,l=m.constructor;if(!m.isFinite()||m.isZero())return new l(m);for(w=!1,o=m.s*D(m.s*m,1/3),!o||Math.abs(o)==1/0?(n=G(m.d),t=m.e,(o=(t-n.length+1)%3)&&(n+=o==1||o==-2?"0":"00"),o=D(n,1/3),t=U((t+1)/3)-(t%3==(t<0?-1:2)),o==1/0?n="5e"+t:(n=o.toExponential(),n=n.slice(0,n.indexOf("e")+1)+t),r=new l(n),r.s=m.s):r=new l(o.toString()),s=(t=l.precision)+3;;)if(a=r,c=a.times(a).times(a),u=c.plus(m),r=C(u.plus(m).times(a),u.plus(c),s+2,1),G(a.d).slice(0,s)===(n=G(r.d)).slice(0,s))if(n=n.slice(s-3,s+1),n=="9999"||!i&&n=="4999"){if(!i&&(g(a,t+1,0),a.times(a).times(a).eq(m))){r=a;break}s+=4,i=1}else{(!+n||!+n.slice(1)&&n.charAt(0)=="5")&&(g(r,t+1,1),e=!r.times(r).times(r).eq(m));break}return w=!0,g(r,t,l.rounding,e)};f.decimalPlaces=f.dp=function(){var t,e=this.d,n=NaN;if(e){if(t=e.length-1,n=(t-U(this.e/b))*b,t=e[t],t)for(;t%10==0;t/=10)n--;n<0&&(n=0)}return n};f.dividedBy=f.div=function(t){return C(this,new this.constructor(t))};f.dividedToIntegerBy=f.divToInt=function(t){var e=this,n=e.constructor;return g(C(e,new n(t),0,1,1),n.precision,n.rounding)};f.equals=f.eq=function(t){return this.cmp(t)===0};f.floor=function(){return g(new this.constructor(this),this.e+1,3)};f.greaterThan=f.gt=function(t){return this.cmp(t)>0};f.greaterThanOrEqualTo=f.gte=function(t){var e=this.cmp(t);return e==1||e===0};f.hyperbolicCosine=f.cosh=function(){var t,e,n,r,i,o=this,s=o.constructor,a=new s(1);if(!o.isFinite())return new s(o.s?1/0:NaN);if(o.isZero())return a;n=s.precision,r=s.rounding,s.precision=n+Math.max(o.e,o.sd())+4,s.rounding=1,i=o.d.length,i<32?(t=Math.ceil(i/3),e=(1/Ze(4,t)).toString()):(t=16,e="2.3283064365386962890625e-10"),o=ke(s,1,o.times(e),new s(1),!0);for(var c,u=t,m=new s(8);u--;)c=o.times(o),o=a.minus(c.times(m.minus(c.times(m))));return g(o,s.precision=n,s.rounding=r,!0)};f.hyperbolicSine=f.sinh=function(){var t,e,n,r,i=this,o=i.constructor;if(!i.isFinite()||i.isZero())return new o(i);if(e=o.precision,n=o.rounding,o.precision=e+Math.max(i.e,i.sd())+4,o.rounding=1,r=i.d.length,r<3)i=ke(o,2,i,i,!0);else{t=1.4*Math.sqrt(r),t=t>16?16:t|0,i=i.times(1/Ze(5,t)),i=ke(o,2,i,i,!0);for(var s,a=new o(5),c=new o(16),u=new o(20);t--;)s=i.times(i),i=i.times(a.plus(s.times(c.times(s).plus(u))))}return o.precision=e,o.rounding=n,g(i,e,n,!0)};f.hyperbolicTangent=f.tanh=function(){var t,e,n=this,r=n.constructor;return n.isFinite()?n.isZero()?new r(n):(t=r.precision,e=r.rounding,r.precision=t+7,r.rounding=1,C(n.sinh(),n.cosh(),r.precision=t,r.rounding=e)):new r(n.s)};f.inverseCosine=f.acos=function(){var t,e=this,n=e.constructor,r=e.abs().cmp(1),i=n.precision,o=n.rounding;return r!==-1?r===0?e.isNeg()?te(n,i,o):new n(0):new n(NaN):e.isZero()?te(n,i+4,o).times(.5):(n.precision=i+6,n.rounding=1,e=e.asin(),t=te(n,i+4,o).times(.5),n.precision=i,n.rounding=o,t.minus(e))};f.inverseHyperbolicCosine=f.acosh=function(){var t,e,n=this,r=n.constructor;return n.lte(1)?new r(n.eq(1)?0:NaN):n.isFinite()?(t=r.precision,e=r.rounding,r.precision=t+Math.max(Math.abs(n.e),n.sd())+4,r.rounding=1,w=!1,n=n.times(n).minus(1).sqrt().plus(n),w=!0,r.precision=t,r.rounding=e,n.ln()):new r(n)};f.inverseHyperbolicSine=f.asinh=function(){var t,e,n=this,r=n.constructor;return!n.isFinite()||n.isZero()?new r(n):(t=r.precision,e=r.rounding,r.precision=t+2*Math.max(Math.abs(n.e),n.sd())+6,r.rounding=1,w=!1,n=n.times(n).plus(1).sqrt().plus(n),w=!0,r.precision=t,r.rounding=e,n.ln())};f.inverseHyperbolicTangent=f.atanh=function(){var t,e,n,r,i=this,o=i.constructor;return i.isFinite()?i.e>=0?new o(i.abs().eq(1)?i.s/0:i.isZero()?i:NaN):(t=o.precision,e=o.rounding,r=i.sd(),Math.max(r,t)<2*-i.e-1?g(new o(i),t,e,!0):(o.precision=n=r-i.e,i=C(i.plus(1),new o(1).minus(i),n+t,1),o.precision=t+4,o.rounding=1,i=i.ln(),o.precision=t,o.rounding=e,i.times(.5))):new o(NaN)};f.inverseSine=f.asin=function(){var t,e,n,r,i=this,o=i.constructor;return i.isZero()?new o(i):(e=i.abs().cmp(1),n=o.precision,r=o.rounding,e!==-1?e===0?(t=te(o,n+4,r).times(.5),t.s=i.s,t):new o(NaN):(o.precision=n+6,o.rounding=1,i=i.div(new o(1).minus(i.times(i)).sqrt().plus(1)).atan(),o.precision=n,o.rounding=r,i.times(2)))};f.inverseTangent=f.atan=function(){var t,e,n,r,i,o,s,a,c,u=this,m=u.constructor,l=m.precision,d=m.rounding;if(u.isFinite()){if(u.isZero())return new m(u);if(u.abs().eq(1)&&l+4<=st)return s=te(m,l+4,d).times(.25),s.s=u.s,s}else{if(!u.s)return new m(NaN);if(l+4<=st)return s=te(m,l+4,d).times(.5),s.s=u.s,s}for(m.precision=a=l+10,m.rounding=1,n=Math.min(28,a/b+2|0),t=n;t;--t)u=u.div(u.times(u).plus(1).sqrt().plus(1));for(w=!1,e=Math.ceil(a/b),r=1,c=u.times(u),s=new m(u),i=u;t!==-1;)if(i=i.times(c),o=s.minus(i.div(r+=2)),i=i.times(c),s=o.plus(i.div(r+=2)),s.d[e]!==void 0)for(t=e;s.d[t]===o.d[t]&&t--;);return n&&(s=s.times(2<<n-1)),w=!0,g(s,m.precision=l,m.rounding=d,!0)};f.isFinite=function(){return!!this.d};f.isInteger=f.isInt=function(){return!!this.d&&U(this.e/b)>this.d.length-2};f.isNaN=function(){return!this.s};f.isNegative=f.isNeg=function(){return this.s<0};f.isPositive=f.isPos=function(){return this.s>0};f.isZero=function(){return!!this.d&&this.d[0]===0};f.lessThan=f.lt=function(t){return this.cmp(t)<0};f.lessThanOrEqualTo=f.lte=function(t){return this.cmp(t)<1};f.logarithm=f.log=function(t){var e,n,r,i,o,s,a,c,u=this,m=u.constructor,l=m.precision,d=m.rounding,p=5;if(t==null)t=new m(10),e=!0;else{if(t=new m(t),n=t.d,t.s<0||!n||!n[0]||t.eq(1))return new m(NaN);e=t.eq(10)}if(n=u.d,u.s<0||!n||!n[0]||u.eq(1))return new m(n&&!n[0]?-1/0:u.s!=1?NaN:n?0:1/0);if(e)if(n.length>1)o=!0;else{for(i=n[0];i%10===0;)i/=10;o=i!==1}if(w=!1,a=l+p,s=pe(u,a),r=e?Xe(m,a+10):pe(t,a),c=C(s,r,a,1),Ce(c.d,i=l,d))do if(a+=10,s=pe(u,a),r=e?Xe(m,a+10):pe(t,a),c=C(s,r,a,1),!o){+G(c.d).slice(i+1,i+15)+1==1e14&&(c=g(c,l+1,0));break}while(Ce(c.d,i+=10,d));return w=!0,g(c,l,d)};f.minus=f.sub=function(t){var e,n,r,i,o,s,a,c,u,m,l,d,p=this,T=p.constructor;if(t=new T(t),!p.d||!t.d)return!p.s||!t.s?t=new T(NaN):p.d?t.s=-t.s:t=new T(t.d||p.s!==t.s?p:NaN),t;if(p.s!=t.s)return t.s=-t.s,p.plus(t);if(u=p.d,d=t.d,a=T.precision,c=T.rounding,!u[0]||!d[0]){if(d[0])t.s=-t.s;else if(u[0])t=new T(p);else return new T(c===3?-0:0);return w?g(t,a,c):t}if(n=U(t.e/b),m=U(p.e/b),u=u.slice(),o=m-n,o){for(l=o<0,l?(e=u,o=-o,s=d.length):(e=d,n=m,s=u.length),r=Math.max(Math.ceil(a/b),s)+2,o>r&&(o=r,e.length=1),e.reverse(),r=o;r--;)e.push(0);e.reverse()}else{for(r=u.length,s=d.length,l=r<s,l&&(s=r),r=0;r<s;r++)if(u[r]!=d[r]){l=u[r]<d[r];break}o=0}for(l&&(e=u,u=d,d=e,t.s=-t.s),s=u.length,r=d.length-s;r>0;--r)u[s++]=0;for(r=d.length;r>o;){if(u[--r]<d[r]){for(i=r;i&&u[--i]===0;)u[i]=ne-1;--u[i],u[r]+=ne}u[r]-=d[r]}for(;u[--s]===0;)u.pop();for(;u[0]===0;u.shift())--n;return u[0]?(t.d=u,t.e=ze(u,n),w?g(t,a,c):t):new T(c===3?-0:0)};f.modulo=f.mod=function(t){var e,n=this,r=n.constructor;return t=new r(t),!n.d||!t.s||t.d&&!t.d[0]?new r(NaN):!t.d||n.d&&!n.d[0]?g(new r(n),r.precision,r.rounding):(w=!1,r.modulo==9?(e=C(n,t.abs(),0,3,1),e.s*=t.s):e=C(n,t,0,r.modulo,1),e=e.times(t),w=!0,n.minus(e))};f.naturalExponential=f.exp=function(){return at(this)};f.naturalLogarithm=f.ln=function(){return pe(this)};f.negated=f.neg=function(){var t=new this.constructor(this);return t.s=-t.s,g(t)};f.plus=f.add=function(t){var e,n,r,i,o,s,a,c,u,m,l=this,d=l.constructor;if(t=new d(t),!l.d||!t.d)return!l.s||!t.s?t=new d(NaN):l.d||(t=new d(t.d||l.s===t.s?l:NaN)),t;if(l.s!=t.s)return t.s=-t.s,l.minus(t);if(u=l.d,m=t.d,a=d.precision,c=d.rounding,!u[0]||!m[0])return m[0]||(t=new d(l)),w?g(t,a,c):t;if(o=U(l.e/b),r=U(t.e/b),u=u.slice(),i=o-r,i){for(i<0?(n=u,i=-i,s=m.length):(n=m,r=o,s=u.length),o=Math.ceil(a/b),s=o>s?o+1:s+1,i>s&&(i=s,n.length=1),n.reverse();i--;)n.push(0);n.reverse()}for(s=u.length,i=m.length,s-i<0&&(i=s,n=m,m=u,u=n),e=0;i;)e=(u[--i]=u[i]+m[i]+e)/ne|0,u[i]%=ne;for(e&&(u.unshift(e),++r),s=u.length;u[--s]==0;)u.pop();return t.d=u,t.e=ze(u,r),w?g(t,a,c):t};f.precision=f.sd=function(t){var e,n=this;if(t!==void 0&&t!==!!t&&t!==1&&t!==0)throw Error(ge+t);return n.d?(e=Ut(n.d),t&&n.e+1>e&&(e=n.e+1)):e=NaN,e};f.round=function(){var t=this,e=t.constructor;return g(new e(t),t.e+1,e.rounding)};f.sine=f.sin=function(){var t,e,n=this,r=n.constructor;return n.isFinite()?n.isZero()?new r(n):(t=r.precision,e=r.rounding,r.precision=t+Math.max(n.e,n.sd())+b,r.rounding=1,n=En(r,zt(r,n)),r.precision=t,r.rounding=e,g(me>2?n.neg():n,t,e,!0)):new r(NaN)};f.squareRoot=f.sqrt=function(){var t,e,n,r,i,o,s=this,a=s.d,c=s.e,u=s.s,m=s.constructor;if(u!==1||!a||!a[0])return new m(!u||u<0&&(!a||a[0])?NaN:a?s:1/0);for(w=!1,u=Math.sqrt(+s),u==0||u==1/0?(e=G(a),(e.length+c)%2==0&&(e+="0"),u=Math.sqrt(e),c=U((c+1)/2)-(c<0||c%2),u==1/0?e="5e"+c:(e=u.toExponential(),e=e.slice(0,e.indexOf("e")+1)+c),r=new m(e)):r=new m(u.toString()),n=(c=m.precision)+3;;)if(o=r,r=o.plus(C(s,o,n+2,1)).times(.5),G(o.d).slice(0,n)===(e=G(r.d)).slice(0,n))if(e=e.slice(n-3,n+1),e=="9999"||!i&&e=="4999"){if(!i&&(g(o,c+1,0),o.times(o).eq(s))){r=o;break}n+=4,i=1}else{(!+e||!+e.slice(1)&&e.charAt(0)=="5")&&(g(r,c+1,1),t=!r.times(r).eq(s));break}return w=!0,g(r,c,m.rounding,t)};f.tangent=f.tan=function(){var t,e,n=this,r=n.constructor;return n.isFinite()?n.isZero()?new r(n):(t=r.precision,e=r.rounding,r.precision=t+10,r.rounding=1,n=n.sin(),n.s=1,n=C(n,new r(1).minus(n.times(n)).sqrt(),t+10,0),r.precision=t,r.rounding=e,g(me==2||me==4?n.neg():n,t,e,!0)):new r(NaN)};f.times=f.mul=function(t){var e,n,r,i,o,s,a,c,u,m=this,l=m.constructor,d=m.d,p=(t=new l(t)).d;if(t.s*=m.s,!d||!d[0]||!p||!p[0])return new l(!t.s||d&&!d[0]&&!p||p&&!p[0]&&!d?NaN:!d||!p?t.s/0:t.s*0);for(n=U(m.e/b)+U(t.e/b),c=d.length,u=p.length,c<u&&(o=d,d=p,p=o,s=c,c=u,u=s),o=[],s=c+u,r=s;r--;)o.push(0);for(r=u;--r>=0;){for(e=0,i=c+r;i>r;)a=o[i]+p[r]*d[i-r-1]+e,o[i--]=a%ne|0,e=a/ne|0;o[i]=(o[i]+e)%ne|0}for(;!o[--s];)o.pop();return e?++n:o.shift(),t.d=o,t.e=ze(o,n),w?g(t,l.precision,l.rounding):t};f.toBinary=function(t,e){return ct(this,2,t,e)};f.toDecimalPlaces=f.toDP=function(t,e){var n=this,r=n.constructor;return n=new r(n),t===void 0?n:(z(t,0,he),e===void 0?e=r.rounding:z(e,0,8),g(n,t+n.e+1,e))};f.toExponential=function(t,e){var n,r=this,i=r.constructor;return t===void 0?n=se(r,!0):(z(t,0,he),e===void 0?e=i.rounding:z(e,0,8),r=g(new i(r),t+1,e),n=se(r,!0,t+1)),r.isNeg()&&!r.isZero()?"-"+n:n};f.toFixed=function(t,e){var n,r,i=this,o=i.constructor;return t===void 0?n=se(i):(z(t,0,he),e===void 0?e=o.rounding:z(e,0,8),r=g(new o(i),t+i.e+1,e),n=se(r,!1,t+r.e+1)),i.isNeg()&&!i.isZero()?"-"+n:n};f.toFraction=function(t){var e,n,r,i,o,s,a,c,u,m,l,d,p=this,T=p.d,y=p.constructor;if(!T)return new y(p);if(u=n=new y(1),r=c=new y(0),e=new y(r),o=e.e=Ut(T)-p.e-1,s=o%b,e.d[0]=D(10,s<0?b+s:s),t==null)t=o>0?e:u;else{if(a=new y(t),!a.isInt()||a.lt(u))throw Error(ge+a);t=a.gt(e)?o>0?e:u:a}for(w=!1,a=new y(G(T)),m=y.precision,y.precision=o=T.length*b*2;l=C(a,e,0,1,1),i=n.plus(l.times(r)),i.cmp(t)!=1;)n=r,r=i,i=u,u=c.plus(l.times(i)),c=i,i=e,e=a.minus(l.times(i)),a=i;return i=C(t.minus(n),r,0,1,1),c=c.plus(i.times(u)),n=n.plus(i.times(r)),c.s=u.s=p.s,d=C(u,r,o,1).minus(p).abs().cmp(C(c,n,o,1).minus(p).abs())<1?[u,r]:[c,n],y.precision=m,w=!0,d};f.toHexadecimal=f.toHex=function(t,e){return ct(this,16,t,e)};f.toNearest=function(t,e){var n=this,r=n.constructor;if(n=new r(n),t==null){if(!n.d)return n;t=new r(1),e=r.rounding}else{if(t=new r(t),e===void 0?e=r.rounding:z(e,0,8),!n.d)return t.s?n:t;if(!t.d)return t.s&&(t.s=n.s),t}return t.d[0]?(w=!1,n=C(n,t,0,e,1).times(t),w=!0,g(n)):(t.s=n.s,n=t),n};f.toNumber=function(){return+this};f.toOctal=function(t,e){return ct(this,8,t,e)};f.toPower=f.pow=function(t){var e,n,r,i,o,s,a=this,c=a.constructor,u=+(t=new c(t));if(!a.d||!t.d||!a.d[0]||!t.d[0])return new c(D(+a,u));if(a=new c(a),a.eq(1))return a;if(r=c.precision,o=c.rounding,t.eq(1))return g(a,r,o);if(e=U(t.e/b),e>=t.d.length-1&&(n=u<0?-u:u)<=Sn)return i=Wt(c,a,n,r),t.s<0?new c(1).div(i):g(i,r,o);if(s=a.s,s<0){if(e<t.d.length-1)return new c(NaN);if((t.d[e]&1)==0&&(s=1),a.e==0&&a.d[0]==1&&a.d.length==1)return a.s=s,a}return n=D(+a,u),e=n==0||!isFinite(n)?U(u*(Math.log("0."+G(a.d))/Math.LN10+a.e+1)):new c(n+"").e,e>c.maxE+1||e<c.minE-1?new c(e>0?s/0:0):(w=!1,c.rounding=a.s=1,n=Math.min(12,(e+"").length),i=at(t.times(pe(a,r+n)),r),i.d&&(i=g(i,r+5,1),Ce(i.d,r,o)&&(e=r+10,i=g(at(t.times(pe(a,e+n)),e),e+5,1),+G(i.d).slice(r+1,r+15)+1==1e14&&(i=g(i,r+1,0)))),i.s=s,w=!0,c.rounding=o,g(i,r,o))};f.toPrecision=function(t,e){var n,r=this,i=r.constructor;return t===void 0?n=se(r,r.e<=i.toExpNeg||r.e>=i.toExpPos):(z(t,1,he),e===void 0?e=i.rounding:z(e,0,8),r=g(new i(r),t,e),n=se(r,t<=r.e||r.e<=i.toExpNeg,t)),r.isNeg()&&!r.isZero()?"-"+n:n};f.toSignificantDigits=f.toSD=function(t,e){var n=this,r=n.constructor;return t===void 0?(t=r.precision,e=r.rounding):(z(t,1,he),e===void 0?e=r.rounding:z(e,0,8)),g(new r(n),t,e)};f.toString=function(){var t=this,e=t.constructor,n=se(t,t.e<=e.toExpNeg||t.e>=e.toExpPos);return t.isNeg()&&!t.isZero()?"-"+n:n};f.truncated=f.trunc=function(){return g(new this.constructor(this),this.e+1,1)};f.valueOf=f.toJSON=function(){var t=this,e=t.constructor,n=se(t,t.e<=e.toExpNeg||t.e>=e.toExpPos);return t.isNeg()?"-"+n:n};function G(t){var e,n,r,i=t.length-1,o="",s=t[0];if(i>0){for(o+=s,e=1;e<i;e++)r=t[e]+"",n=b-r.length,n&&(o+=fe(n)),o+=r;s=t[e],r=s+"",n=b-r.length,n&&(o+=fe(n))}else if(s===0)return"0";for(;s%10===0;)s/=10;return o+s}function z(t,e,n){if(t!==~~t||t<e||t>n)throw Error(ge+t)}function Ce(t,e,n,r){var i,o,s,a;for(o=t[0];o>=10;o/=10)--e;return--e<0?(e+=b,i=0):(i=Math.ceil((e+1)/b),e%=b),o=D(10,b-e),a=t[i]%o|0,r==null?e<3?(e==0?a=a/100|0:e==1&&(a=a/10|0),s=n<4&&a==99999||n>3&&a==49999||a==5e4||a==0):s=(n<4&&a+1==o||n>3&&a+1==o/2)&&(t[i+1]/o/100|0)==D(10,e-2)-1||(a==o/2||a==0)&&(t[i+1]/o/100|0)==0:e<4?(e==0?a=a/1e3|0:e==1?a=a/100|0:e==2&&(a=a/10|0),s=(r||n<4)&&a==9999||!r&&n>3&&a==4999):s=((r||n<4)&&a+1==o||!r&&n>3&&a+1==o/2)&&(t[i+1]/o/1e3|0)==D(10,e-3)-1,s}function Ve(t,e,n){for(var r,i=[0],o,s=0,a=t.length;s<a;){for(o=i.length;o--;)i[o]*=e;for(i[0]+=it.indexOf(t.charAt(s++)),r=0;r<i.length;r++)i[r]>n-1&&(i[r+1]===void 0&&(i[r+1]=0),i[r+1]+=i[r]/n|0,i[r]%=n)}return i.reverse()}function Ln(t,e){var n,r,i;if(e.isZero())return e;r=e.d.length,r<32?(n=Math.ceil(r/3),i=(1/Ze(4,n)).toString()):(n=16,i="2.3283064365386962890625e-10"),t.precision+=n,e=ke(t,1,e.times(i),new t(1));for(var o=n;o--;){var s=e.times(e);e=s.times(s).minus(s).times(8).plus(1)}return t.precision-=n,e}var C=function(){function t(r,i,o){var s,a=0,c=r.length;for(r=r.slice();c--;)s=r[c]*i+a,r[c]=s%o|0,a=s/o|0;return a&&r.unshift(a),r}function e(r,i,o,s){var a,c;if(o!=s)c=o>s?1:-1;else for(a=c=0;a<o;a++)if(r[a]!=i[a]){c=r[a]>i[a]?1:-1;break}return c}function n(r,i,o,s){for(var a=0;o--;)r[o]-=a,a=r[o]<i[o]?1:0,r[o]=a*s+r[o]-i[o];for(;!r[0]&&r.length>1;)r.shift()}return function(r,i,o,s,a,c){var u,m,l,d,p,T,y,M,N,q,I,v,we,ue,tt,Ke,Se,nt,ee,qe,Ge=r.constructor,rt=r.s==i.s?1:-1,V=r.d,L=i.d;if(!V||!V[0]||!L||!L[0])return new Ge(!r.s||!i.s||(V?L&&V[0]==L[0]:!L)?NaN:V&&V[0]==0||!L?rt*0:rt/0);for(c?(p=1,m=r.e-i.e):(c=ne,p=b,m=U(r.e/p)-U(i.e/p)),ee=L.length,Se=V.length,N=new Ge(rt),q=N.d=[],l=0;L[l]==(V[l]||0);l++);if(L[l]>(V[l]||0)&&m--,o==null?(ue=o=Ge.precision,s=Ge.rounding):a?ue=o+(r.e-i.e)+1:ue=o,ue<0)q.push(1),T=!0;else{if(ue=ue/p+2|0,l=0,ee==1){for(d=0,L=L[0],ue++;(l<Se||d)&&ue--;l++)tt=d*c+(V[l]||0),q[l]=tt/L|0,d=tt%L|0;T=d||l<Se}else{for(d=c/(L[0]+1)|0,d>1&&(L=t(L,d,c),V=t(V,d,c),ee=L.length,Se=V.length),Ke=ee,I=V.slice(0,ee),v=I.length;v<ee;)I[v++]=0;qe=L.slice(),qe.unshift(0),nt=L[0],L[1]>=c/2&&++nt;do d=0,u=e(L,I,ee,v),u<0?(we=I[0],ee!=v&&(we=we*c+(I[1]||0)),d=we/nt|0,d>1?(d>=c&&(d=c-1),y=t(L,d,c),M=y.length,v=I.length,u=e(y,I,M,v),u==1&&(d--,n(y,ee<M?qe:L,M,c))):(d==0&&(u=d=1),y=L.slice()),M=y.length,M<v&&y.unshift(0),n(I,y,v,c),u==-1&&(v=I.length,u=e(L,I,ee,v),u<1&&(d++,n(I,ee<v?qe:L,v,c))),v=I.length):u===0&&(d++,I=[0]),q[l++]=d,u&&I[0]?I[v++]=V[Ke]||0:(I=[V[Ke]],v=1);while((Ke++<Se||I[0]!==void 0)&&ue--);T=I[0]!==void 0}q[0]||q.shift()}if(p==1)N.e=m,Ot=T;else{for(l=1,d=q[0];d>=10;d/=10)l++;N.e=l+m*p-1,g(N,a?o+N.e+1:o,s,T)}return N}}();function g(t,e,n,r){var i,o,s,a,c,u,m,l,d,p=t.constructor;e:if(e!=null){if(l=t.d,!l)return t;for(i=1,a=l[0];a>=10;a/=10)i++;if(o=e-i,o<0)o+=b,s=e,m=l[d=0],c=m/D(10,i-s-1)%10|0;else if(d=Math.ceil((o+1)/b),a=l.length,d>=a)if(r){for(;a++<=d;)l.push(0);m=c=0,i=1,o%=b,s=o-b+1}else break e;else{for(m=a=l[d],i=1;a>=10;a/=10)i++;o%=b,s=o-b+i,c=s<0?0:m/D(10,i-s-1)%10|0}if(r=r||e<0||l[d+1]!==void 0||(s<0?m:m%D(10,i-s-1)),u=n<4?(c||r)&&(n==0||n==(t.s<0?3:2)):c>5||c==5&&(n==4||r||n==6&&(o>0?s>0?m/D(10,i-s):0:l[d-1])%10&1||n==(t.s<0?8:7)),e<1||!l[0])return l.length=0,u?(e-=t.e+1,l[0]=D(10,(b-e%b)%b),t.e=-e||0):l[0]=t.e=0,t;if(o==0?(l.length=d,a=1,d--):(l.length=d+1,a=D(10,b-o),l[d]=s>0?(m/D(10,i-s)%D(10,s)|0)*a:0),u)for(;;)if(d==0){for(o=1,s=l[0];s>=10;s/=10)o++;for(s=l[0]+=a,a=1;s>=10;s/=10)a++;o!=a&&(t.e++,l[0]==ne&&(l[0]=1));break}else{if(l[d]+=a,l[d]!=ne)break;l[d--]=0,a=1}for(o=l.length;l[--o]===0;)l.pop()}return w&&(t.e>p.maxE?(t.d=null,t.e=NaN):t.e<p.minE&&(t.e=0,t.d=[0])),t}function se(t,e,n){if(!t.isFinite())return Ht(t);var r,i=t.e,o=G(t.d),s=o.length;return e?(n&&(r=n-s)>0?o=o.charAt(0)+"."+o.slice(1)+fe(r):s>1&&(o=o.charAt(0)+"."+o.slice(1)),o=o+(t.e<0?"e":"e+")+t.e):i<0?(o="0."+fe(-i-1)+o,n&&(r=n-s)>0&&(o+=fe(r))):i>=s?(o+=fe(i+1-s),n&&(r=n-i-1)>0&&(o=o+"."+fe(r))):((r=i+1)<s&&(o=o.slice(0,r)+"."+o.slice(r)),n&&(r=n-s)>0&&(i+1===s&&(o+="."),o+=fe(r))),o}function ze(t,e){var n=t[0];for(e*=b;n>=10;n/=10)e++;return e}function Xe(t,e,n){if(e>Cn)throw w=!0,n&&(t.precision=n),Error(Kt);return g(new t(Ue),e,1,!0)}function te(t,e,n){if(e>st)throw Error(Kt);return g(new t(We),e,n,!0)}function Ut(t){var e=t.length-1,n=e*b+1;if(e=t[e],e){for(;e%10==0;e/=10)n--;for(e=t[0];e>=10;e/=10)n++}return n}function fe(t){for(var e="";t--;)e+="0";return e}function Wt(t,e,n,r){var i,o=new t(1),s=Math.ceil(r/b+4);for(w=!1;;){if(n%2&&(o=o.times(e),vt(o.d,s)&&(i=!0)),n=U(n/2),n===0){n=o.d.length-1,i&&o.d[n]===0&&++o.d[n];break}e=e.times(e),vt(e.d,s)}return w=!0,o}function Mt(t){return t.d[t.d.length-1]&1}function Xt(t,e,n){for(var r,i=new t(e[0]),o=0;++o<e.length;)if(r=new t(e[o]),r.s)i[n](r)&&(i=r);else{i=r;break}return i}function at(t,e){var n,r,i,o,s,a,c,u=0,m=0,l=0,d=t.constructor,p=d.rounding,T=d.precision;if(!t.d||!t.d[0]||t.e>17)return new d(t.d?t.d[0]?t.s<0?0:1/0:1:t.s?t.s<0?0:t:0/0);for(e==null?(w=!1,c=T):c=e,a=new d(.03125);t.e>-2;)t=t.times(a),l+=5;for(r=Math.log(D(2,l))/Math.LN10*2+5|0,c+=r,n=o=s=new d(1),d.precision=c;;){if(o=g(o.times(t),c,1),n=n.times(++m),a=s.plus(C(o,n,c,1)),G(a.d).slice(0,c)===G(s.d).slice(0,c)){for(i=l;i--;)s=g(s.times(s),c,1);if(e==null)if(u<3&&Ce(s.d,c-r,p,u))d.precision=c+=10,n=o=a=new d(1),m=0,u++;else return g(s,d.precision=T,p,w=!0);else return d.precision=T,s}s=a}}function pe(t,e){var n,r,i,o,s,a,c,u,m,l,d,p=1,T=10,y=t,M=y.d,N=y.constructor,q=N.rounding,I=N.precision;if(y.s<0||!M||!M[0]||!y.e&&M[0]==1&&M.length==1)return new N(M&&!M[0]?-1/0:y.s!=1?NaN:M?0:y);if(e==null?(w=!1,m=I):m=e,N.precision=m+=T,n=G(M),r=n.charAt(0),Math.abs(o=y.e)<15e14){for(;r<7&&r!=1||r==1&&n.charAt(1)>3;)y=y.times(t),n=G(y.d),r=n.charAt(0),p++;o=y.e,r>1?(y=new N("0."+n),o++):y=new N(r+"."+n.slice(1))}else return u=Xe(N,m+2,I).times(o+""),y=pe(new N(r+"."+n.slice(1)),m-T).plus(u),N.precision=I,e==null?g(y,I,q,w=!0):y;for(l=y,c=s=y=C(y.minus(1),y.plus(1),m,1),d=g(y.times(y),m,1),i=3;;){if(s=g(s.times(d),m,1),u=c.plus(C(s,new N(i),m,1)),G(u.d).slice(0,m)===G(c.d).slice(0,m))if(c=c.times(2),o!==0&&(c=c.plus(Xe(N,m+2,I).times(o+""))),c=C(c,new N(p),m,1),e==null)if(Ce(c.d,m-T,q,a))N.precision=m+=T,u=s=y=C(l.minus(1),l.plus(1),m,1),d=g(y.times(y),m,1),i=a=1;else return g(c,N.precision=I,q,w=!0);else return N.precision=I,c;c=u,i+=2}}function Ht(t){return String(t.s*t.s/0)}function ut(t,e){var n,r,i;for((n=e.indexOf("."))>-1&&(e=e.replace(".","")),(r=e.search(/e/i))>0?(n<0&&(n=r),n+=+e.slice(r+1),e=e.substring(0,r)):n<0&&(n=e.length),r=0;e.charCodeAt(r)===48;r++);for(i=e.length;e.charCodeAt(i-1)===48;--i);if(e=e.slice(r,i),e){if(i-=r,t.e=n=n-r-1,t.d=[],r=(n+1)%b,n<0&&(r+=b),r<i){for(r&&t.d.push(+e.slice(0,r)),i-=b;r<i;)t.d.push(+e.slice(r,r+=b));e=e.slice(r),r=b-e.length}else r-=i;for(;r--;)e+="0";t.d.push(+e),w&&(t.e>t.constructor.maxE?(t.d=null,t.e=NaN):t.e<t.constructor.minE&&(t.e=0,t.d=[0]))}else t.e=0,t.d=[0];return t}function Rn(t,e){var n,r,i,o,s,a,c,u,m;if(e.indexOf("_")>-1){if(e=e.replace(/(\d)_(?=\d)/g,"$1"),Vt.test(e))return ut(t,e)}else if(e==="Infinity"||e==="NaN")return+e||(t.s=NaN),t.e=NaN,t.d=null,t;if(In.test(e))n=16,e=e.toLowerCase();else if(Bn.test(e))n=2;else if(Nn.test(e))n=8;else throw Error(ge+e);for(o=e.search(/p/i),o>0?(c=+e.slice(o+1),e=e.substring(2,o)):e=e.slice(2),o=e.indexOf("."),s=o>=0,r=t.constructor,s&&(e=e.replace(".",""),a=e.length,o=a-o,i=Wt(r,new r(n),o,o*2)),u=Ve(e,n,ne),m=u.length-1,o=m;u[o]===0;--o)u.pop();return o<0?new r(t.s*0):(t.e=ze(u,m),t.d=u,w=!1,s&&(t=C(t,i,a*4)),c&&(t=t.times(Math.abs(c)<54?D(2,c):Le.pow(2,c))),w=!0,t)}function En(t,e){var n,r=e.d.length;if(r<3)return e.isZero()?e:ke(t,2,e,e);n=1.4*Math.sqrt(r),n=n>16?16:n|0,e=e.times(1/Ze(5,n)),e=ke(t,2,e,e);for(var i,o=new t(5),s=new t(16),a=new t(20);n--;)i=e.times(e),e=e.times(o.plus(i.times(s.times(i).minus(a))));return e}function ke(t,e,n,r,i){var o,s,a,c,u=1,m=t.precision,l=Math.ceil(m/b);for(w=!1,c=n.times(n),a=new t(r);;){if(s=C(a.times(c),new t(e++*e++),m,1),a=i?r.plus(s):r.minus(s),r=C(s.times(c),new t(e++*e++),m,1),s=a.plus(r),s.d[l]!==void 0){for(o=l;s.d[o]===a.d[o]&&o--;);if(o==-1)break}o=a,a=r,r=s,s=o,u++}return w=!0,s.d.length=l+1,s}function Ze(t,e){for(var n=t;--e;)n*=t;return n}function zt(t,e){var n,r=e.s<0,i=te(t,t.precision,1),o=i.times(.5);if(e=e.abs(),e.lte(o))return me=r?4:1,e;if(n=e.divToInt(i),n.isZero())me=r?3:2;else{if(e=e.minus(n.times(i)),e.lte(o))return me=Mt(n)?r?2:3:r?4:1,e;me=Mt(n)?r?1:4:r?3:2}return e.minus(i).abs()}function ct(t,e,n,r){var i,o,s,a,c,u,m,l,d,p=t.constructor,T=n!==void 0;if(T?(z(n,1,he),r===void 0?r=p.rounding:z(r,0,8)):(n=p.precision,r=p.rounding),!t.isFinite())m=Ht(t);else{for(m=se(t),s=m.indexOf("."),T?(i=2,e==16?n=n*4-3:e==8&&(n=n*3-2)):i=e,s>=0&&(m=m.replace(".",""),d=new p(1),d.e=m.length-s,d.d=Ve(se(d),10,i),d.e=d.d.length),l=Ve(m,10,i),o=c=l.length;l[--c]==0;)l.pop();if(!l[0])m=T?"0p+0":"0";else{if(s<0?o--:(t=new p(t),t.d=l,t.e=o,t=C(t,d,n,r,0,i),l=t.d,o=t.e,u=Ot),s=l[n],a=i/2,u=u||l[n+1]!==void 0,u=r<4?(s!==void 0||u)&&(r===0||r===(t.s<0?3:2)):s>a||s===a&&(r===4||u||r===6&&l[n-1]&1||r===(t.s<0?8:7)),l.length=n,u)for(;++l[--n]>i-1;)l[n]=0,n||(++o,l.unshift(1));for(c=l.length;!l[c-1];--c);for(s=0,m="";s<c;s++)m+=it.charAt(l[s]);if(T){if(c>1)if(e==16||e==8){for(s=e==16?4:3,--c;c%s;c++)m+="0";for(l=Ve(m,i,e),c=l.length;!l[c-1];--c);for(s=1,m="1.";s<c;s++)m+=it.charAt(l[s])}else m=m.charAt(0)+"."+m.slice(1);m=m+(o<0?"p":"p+")+o}else if(o<0){for(;++o;)m="0"+m;m="0."+m}else if(++o>c)for(o-=c;o--;)m+="0";else o<c&&(m=m.slice(0,o)+"."+m.slice(o))}m=(e==16?"0x":e==2?"0b":e==8?"0o":"")+m}return t.s<0?"-"+m:m}function vt(t,e){if(t.length>e)return t.length=e,!0}function _n(t){return new this(t).abs()}function Fn(t){return new this(t).acos()}function Mn(t){return new this(t).acosh()}function vn(t,e){return new this(t).plus(e)}function Dn(t){return new this(t).asin()}function On(t){return new this(t).asinh()}function Kn(t){return new this(t).atan()}function qn(t){return new this(t).atanh()}function Gn(t,e){t=new this(t),e=new this(e);var n,r=this.precision,i=this.rounding,o=r+4;return!t.s||!e.s?n=new this(NaN):!t.d&&!e.d?(n=te(this,o,1).times(e.s>0?.25:.75),n.s=t.s):!e.d||t.isZero()?(n=e.s<0?te(this,r,i):new this(0),n.s=t.s):!t.d||e.isZero()?(n=te(this,o,1).times(.5),n.s=t.s):e.s<0?(this.precision=o,this.rounding=1,n=this.atan(C(t,e,o,1)),e=te(this,o,1),this.precision=r,this.rounding=i,n=t.s<0?n.minus(e):n.plus(e)):n=this.atan(C(t,e,o,1)),n}function Vn(t){return new this(t).cbrt()}function Un(t){return g(t=new this(t),t.e+1,2)}function Wn(t,e,n){return new this(t).clamp(e,n)}function Xn(t){if(!t||typeof t!="object")throw Error(He+"Object expected");var e,n,r,i=t.defaults===!0,o=["precision",1,he,"rounding",0,8,"toExpNeg",-Pe,0,"toExpPos",0,Pe,"maxE",0,Pe,"minE",-Pe,0,"modulo",0,9];for(e=0;e<o.length;e+=3)if(n=o[e],i&&(this[n]=ot[n]),(r=t[n])!==void 0)if(U(r)===r&&r>=o[e+1]&&r<=o[e+2])this[n]=r;else throw Error(ge+n+": "+r);if(n="crypto",i&&(this[n]=ot[n]),(r=t[n])!==void 0)if(r===!0||r===!1||r===0||r===1)if(r)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))this[n]=!0;else throw Error(qt);else this[n]=!1;else throw Error(ge+n+": "+r);return this}function Hn(t){return new this(t).cos()}function zn(t){return new this(t).cosh()}function Zt(t){var e,n,r;function i(o){var s,a,c,u=this;if(!(u instanceof i))return new i(o);if(u.constructor=i,Dt(o)){u.s=o.s,w?!o.d||o.e>i.maxE?(u.e=NaN,u.d=null):o.e<i.minE?(u.e=0,u.d=[0]):(u.e=o.e,u.d=o.d.slice()):(u.e=o.e,u.d=o.d?o.d.slice():o.d);return}if(c=typeof o,c==="number"){if(o===0){u.s=1/o<0?-1:1,u.e=0,u.d=[0];return}if(o<0?(o=-o,u.s=-1):u.s=1,o===~~o&&o<1e7){for(s=0,a=o;a>=10;a/=10)s++;w?s>i.maxE?(u.e=NaN,u.d=null):s<i.minE?(u.e=0,u.d=[0]):(u.e=s,u.d=[o]):(u.e=s,u.d=[o]);return}else if(o*0!==0){o||(u.s=NaN),u.e=NaN,u.d=null;return}return ut(u,o.toString())}else if(c!=="string")throw Error(ge+o);return(a=o.charCodeAt(0))===45?(o=o.slice(1),u.s=-1):(a===43&&(o=o.slice(1)),u.s=1),Vt.test(o)?ut(u,o):Rn(u,o)}if(i.prototype=f,i.ROUND_UP=0,i.ROUND_DOWN=1,i.ROUND_CEIL=2,i.ROUND_FLOOR=3,i.ROUND_HALF_UP=4,i.ROUND_HALF_DOWN=5,i.ROUND_HALF_EVEN=6,i.ROUND_HALF_CEIL=7,i.ROUND_HALF_FLOOR=8,i.EUCLID=9,i.config=i.set=Xn,i.clone=Zt,i.isDecimal=Dt,i.abs=_n,i.acos=Fn,i.acosh=Mn,i.add=vn,i.asin=Dn,i.asinh=On,i.atan=Kn,i.atanh=qn,i.atan2=Gn,i.cbrt=Vn,i.ceil=Un,i.clamp=Wn,i.cos=Hn,i.cosh=zn,i.div=Zn,i.exp=Yn,i.floor=jn,i.hypot=Jn,i.ln=Qn,i.log=$n,i.log10=tr,i.log2=er,i.max=nr,i.min=rr,i.mod=ir,i.mul=or,i.pow=sr,i.random=ar,i.round=ur,i.sign=cr,i.sin=mr,i.sinh=lr,i.sqrt=dr,i.sub=fr,i.sum=pr,i.tan=gr,i.tanh=hr,i.trunc=br,t===void 0&&(t={}),t&&t.defaults!==!0)for(r=["precision","rounding","toExpNeg","toExpPos","maxE","minE","modulo","crypto"],e=0;e<r.length;)t.hasOwnProperty(n=r[e++])||(t[n]=this[n]);return i.config(t),i}function Zn(t,e){return new this(t).div(e)}function Yn(t){return new this(t).exp()}function jn(t){return g(t=new this(t),t.e+1,3)}function Jn(){var t,e,n=new this(0);for(w=!1,t=0;t<arguments.length;)if(e=new this(arguments[t++]),e.d)n.d&&(n=n.plus(e.times(e)));else{if(e.s)return w=!0,new this(1/0);n=e}return w=!0,n.sqrt()}function Dt(t){return t instanceof Le||t&&t.toStringTag===Gt||!1}function Qn(t){return new this(t).ln()}function $n(t,e){return new this(t).log(e)}function er(t){return new this(t).log(2)}function tr(t){return new this(t).log(10)}function nr(){return Xt(this,arguments,"lt")}function rr(){return Xt(this,arguments,"gt")}function ir(t,e){return new this(t).mod(e)}function or(t,e){return new this(t).mul(e)}function sr(t,e){return new this(t).pow(e)}function ar(t){var e,n,r,i,o=0,s=new this(1),a=[];if(t===void 0?t=this.precision:z(t,1,he),r=Math.ceil(t/b),this.crypto)if(crypto.getRandomValues)for(e=crypto.getRandomValues(new Uint32Array(r));o<r;)i=e[o],i>=429e7?e[o]=crypto.getRandomValues(new Uint32Array(1))[0]:a[o++]=i%1e7;else if(crypto.randomBytes){for(e=crypto.randomBytes(r*=4);o<r;)i=e[o]+(e[o+1]<<8)+(e[o+2]<<16)+((e[o+3]&127)<<24),i>=214e7?crypto.randomBytes(4).copy(e,o):(a.push(i%1e7),o+=4);o=r/4}else throw Error(qt);else for(;o<r;)a[o++]=Math.random()*1e7|0;for(r=a[--o],t%=b,r&&t&&(i=D(10,b-t),a[o]=(r/i|0)*i);a[o]===0;o--)a.pop();if(o<0)n=0,a=[0];else{for(n=-1;a[0]===0;n-=b)a.shift();for(r=1,i=a[0];i>=10;i/=10)r++;r<b&&(n-=b-r)}return s.e=n,s.d=a,s}function ur(t){return g(t=new this(t),t.e+1,this.rounding)}function cr(t){return t=new this(t),t.d?t.d[0]?t.s:0*t.s:t.s||NaN}function mr(t){return new this(t).sin()}function lr(t){return new this(t).sinh()}function dr(t){return new this(t).sqrt()}function fr(t,e){return new this(t).sub(e)}function pr(){var t=0,e=arguments,n=new this(e[t]);for(w=!1;n.s&&++t<e.length;)n=n.plus(e[t]);return w=!0,g(n,this.precision,this.rounding)}function gr(t){return new this(t).tan()}function hr(t){return new this(t).tanh()}function br(t){return g(t=new this(t),t.e+1,1)}f[Symbol.for("nodejs.util.inspect.custom")]=f.toString;f[Symbol.toStringTag]="Decimal";var Le=f.constructor=Zt(ot);Ue=new Le(Ue);We=new Le(We);var O=Le;import{PublicKey as pi}from"@solana/web3.js";import{get as Yt,set as yr}from"lodash";var mt=class{constructor(e){this.logLevel=e.logLevel!==void 0?e.logLevel:0,this.name=e.name}set level(e){this.logLevel=e}get time(){return Date.now().toString()}get moduleName(){return this.name}isLogLevel(e){return e<=this.logLevel}error(...e){return this.isLogLevel(0)?(console.error(this.time,this.name,"sdk logger error",...e),this):this}logWithError(...e){let n=e.map(r=>typeof r=="object"?JSON.stringify(r):r).join(", ");throw new Error(n)}warning(...e){return this.isLogLevel(1)?(console.warn(this.time,this.name,"sdk logger warning",...e),this):this}info(...e){return this.isLogLevel(2)?(console.info(this.time,this.name,"sdk logger info",...e),this):this}debug(...e){return this.isLogLevel(3)?(console.debug(this.time,this.name,"sdk logger debug",...e),this):this}},jt={},wr={};function j(t){let e=Yt(jt,t);if(!e){let n=Yt(wr,t);e=new mt({name:t,logLevel:n}),yr(jt,t,e)}return e}import{MINT_SIZE as yi,TOKEN_PROGRAM_ID as wi,getTransferFeeConfig as Ti,unpackMint as xi}from"@solana/spl-token";var Ai=j("Raydium_accountInfo_util");import de from"bn.js";import Sr from"big.js";import qi from"bn.js";import xr from"toformat";var Ar=xr,Re=Ar;import je from"big.js";import kr from"bn.js";import Br from"decimal.js-light";import Ee from"bn.js";var Jt=9007199254740991;function le(t){let e=j("Raydium_parseBigNumberish");if(t instanceof Ee)return t;if(typeof t=="string"){if(t.match(/^-?[0-9]+$/))return new Ee(t);e.logWithError(`invalid BigNumberish string: ${t}`)}return typeof t=="number"?(t%1&&e.logWithError(`BigNumberish number underflow: ${t}`),(t>=Jt||t<=-Jt)&&e.logWithError(`BigNumberish number overflow: ${t}`),new Ee(String(t))):typeof t=="bigint"?new Ee(t.toString()):(e.error(`invalid BigNumberish value: ${t}`),new Ee(0))}var Ye=j("module/fraction"),dt=Re(je),_e=Re(Br),Ir={[0]:_e.ROUND_DOWN,[1]:_e.ROUND_HALF_UP,[2]:_e.ROUND_UP},Nr={[0]:je.roundDown,[1]:je.roundHalfUp,[2]:je.roundUp},R=class{constructor(e,n=new kr(1)){this.numerator=le(e),this.denominator=le(n)}get quotient(){return this.numerator.div(this.denominator)}invert(){return new R(this.denominator,this.numerator)}add(e){let n=e instanceof R?e:new R(le(e));return this.denominator.eq(n.denominator)?new R(this.numerator.add(n.numerator),this.denominator):new R(this.numerator.mul(n.denominator).add(n.numerator.mul(this.denominator)),this.denominator.mul(n.denominator))}sub(e){let n=e instanceof R?e:new R(le(e));return this.denominator.eq(n.denominator)?new R(this.numerator.sub(n.numerator),this.denominator):new R(this.numerator.mul(n.denominator).sub(n.numerator.mul(this.denominator)),this.denominator.mul(n.denominator))}mul(e){let n=e instanceof R?e:new R(le(e));return new R(this.numerator.mul(n.numerator),this.denominator.mul(n.denominator))}div(e){let n=e instanceof R?e:new R(le(e));return new R(this.numerator.mul(n.denominator),this.denominator.mul(n.numerator))}toSignificant(e,n={groupSeparator:""},r=1){Number.isInteger(e)||Ye.logWithError(`${e} is not an integer.`),e<=0&&Ye.logWithError(`${e} is not positive.`),_e.set({precision:e+1,rounding:Ir[r]});let i=new _e(this.numerator.toString()).div(this.denominator.toString()).toSignificantDigits(e);return i.toFormat(i.decimalPlaces(),n)}toFixed(e,n={groupSeparator:""},r=1){return Number.isInteger(e)||Ye.logWithError(`${e} is not an integer.`),e<0&&Ye.logWithError(`${e} is negative.`),dt.DP=e,dt.RM=Nr[r]||1,new dt(this.numerator.toString()).div(this.denominator.toString()).toFormat(e,n)}isZero(){return this.numerator.isZero()}};var Yi=j("Raydium_amount"),ji=Re(Sr);import{PublicKey as Lr}from"@solana/web3.js";import{TOKEN_PROGRAM_ID as Qt}from"@solana/spl-token";var $t={chainId:101,address:Lr.default.toBase58(),programId:Qt.toBase58(),decimals:9,symbol:"SOL",name:"solana",logoURI:"https://img-v1.raydium.io/icon/So11111111111111111111111111111111111111112.png",tags:[],priority:2,type:"raydium",extensions:{coingeckoId:"solana"}},Te={chainId:101,address:"So11111111111111111111111111111111111111112",programId:Qt.toBase58(),decimals:9,symbol:"WSOL",name:"Wrapped SOL",logoURI:"https://img-v1.raydium.io/icon/So11111111111111111111111111111111111111112.png",tags:[],priority:2,type:"raydium",extensions:{coingeckoId:"solana"}};import{PublicKey as pt}from"@solana/web3.js";import{PublicKey as E,SystemProgram as en,SYSVAR_RENT_PUBKEY as Rr}from"@solana/web3.js";import{TOKEN_PROGRAM_ID as Er}from"@solana/spl-token";function ft({pubkey:t,isSigner:e=!1,isWritable:n=!0}){return{pubkey:t,isWritable:n,isSigner:e}}var io=[ft({pubkey:Er,isWritable:!1}),ft({pubkey:en.programId,isWritable:!1}),ft({pubkey:Rr,isWritable:!1})];function tn({publicKey:t,transformSol:e}){let n=nn(t.toString());if(n instanceof E)return e&&n.equals(Fe)?lt:n;if(e&&n.toString()===Fe.toBase58())return lt;if(typeof n=="string"){if(n===E.default.toBase58())return E.default;try{return new E(n)}catch{throw new Error("invalid public key")}}throw new Error("invalid public key")}function nn(t){try{return new E(t)}catch{return t}}var oo=new E("MemoSq4gqABAXKb96qnH8TysNcWxMyWCqXgDLGmfcHr"),so=new E("MemoSq4gqABAXKb96qnH8TysNcWxMyWCqXgDLGmfcHr"),ao=new E("SysvarRent111111111111111111111111111111111"),uo=new E("SysvarC1ock11111111111111111111111111111111"),_r=new E("metaqbxxUerdq28cj1RbAWkYQm3ybzjb6a8bt518x1s"),co=new E("Sysvar1nstructions1111111111111111111111111"),mo=en.programId,lo=new E("4k3Dyjzvzp8eMZWUXbBCjEvwSkkk59S5iCNLY3QrkX6R"),fo=new E("Ea5SjE2Y6yvCeW5dYTn7PYMuW5ikXkvbGdcmSnXeaLjS"),po=new E("SRMuApVNdxXokk5GT7XD5cUUgXMBCoAz2LHeuAoKWRt"),go=new E("EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v"),ho=new E("Es9vMFrzaCERmJfrF4H2FYD4KCoNkY11McCe8BenwNYB"),bo=new E("mSoLzYCxHdYgdzU16g5QSh3i5K3z3KZK7ytfqcJm7So"),yo=new E("7dHbWXmci3dT8UFYWYZweBLXgycu7Y3iL6trKn1Y7ARj"),wo=new E("USDH1SM1ojwWUga67PGrgFWUHibbjqMvuMaDkRJTgkX"),To=new E("NRVwhjBQiUPYtfDT5zRBVJajzFQHaBUNtC7SNVvqRFa"),xo=new E("ANAxByE6G2WjFp7A4NqtWYXb3mgruyzZYg3spfxe6Lbo"),Ao=new E("7vfCXTUXx5WJV5JADk17DUJ4ksgau7utNKj4b963voxs"),lt=new E("So11111111111111111111111111111111111111112"),Fe=E.default;var gt=class{constructor({mint:e,decimals:n,symbol:r,name:i,skipMint:o=!1,isToken2022:s=!1}){if(e===Fe.toBase58()||e instanceof pt&&Fe.equals(e)){this.decimals=Te.decimals,this.symbol=Te.symbol,this.name=Te.name,this.mint=new pt(Te.address),this.isToken2022=!1;return}this.decimals=n,this.symbol=r||e.toString().substring(0,6),this.name=i||e.toString().substring(0,6),this.mint=o?pt.default:tn({publicKey:e}),this.isToken2022=s}equals(e){return this===e?!0:this.mint.equals(e.mint)}},xe=gt;xe.WSOL=new gt(ce(oe({},Te),{mint:Te.address}));var ht=class{constructor({decimals:e,symbol:n="UNKNOWN",name:r="UNKNOWN"}){this.decimals=e,this.symbol=n,this.name=r}equals(e){return this===e}},Je=ht;Je.SOL=new ht($t);import Fr from"bn.js";var Fo=new R(new Fr(100));var qo=j("Raydium_price");var Mr=new de(0),ps=new de(1),gs=new de(2),hs=new de(3),bs=new de(5),Cr=new de(10),ys=new de(100),ws=new de(1e3),Ts=new de(1e4);import{PublicKey as Xs}from"@solana/web3.js";import{TOKEN_PROGRAM_ID as zs}from"@solana/spl-token";import{ComputeBudgetProgram as Ss,Keypair as Rs,PublicKey as Es,Transaction as Fs,TransactionMessage as vs,VersionedTransaction as Ds}from"@solana/web3.js";import{TOKEN_PROGRAM_ID as Gs}from"@solana/spl-token";var Vs=j("Raydium_txUtil");import{PublicKey as h}from"@solana/web3.js";var Js=new h("EhhTKczWMGQt46ynNeRX1WfeagwwJd7ufHvCDjRxjo5Q"),Qs=new h("CBuCnLe26faBpcBP2fktp4rp8abpcAnTWft6ZrP5Q4T"),$s=new h("9KEPoZmtHUrBbhWN1v1KWLMkkvwY6WLtAVUCPRtRjP4z"),ea=new h("FarmqiPv5eAj3j1GMdMCMUGXqPUvmquZtMy86QH6rzhG"),ta=new h("CLaimxFqjHzgTJtAGHU47NPhg6qrc5sCnpC4tBLyABQS"),na=new h("srmqPvymJeFKQ4zGQed1GFppgkRHL9kaELCbyksJtPX"),ra=new h("9xQeWvG816bUx9EPjHmaT23yvVM2ZWbrrpZb9PusVFin"),ia=new h("675kPX9MHTjS2zt1qfr1NYHuzeLXfQM9H24wFSUt1Mp8"),oa=new h("5quBtoiQqxF9Jv6KYKctB59NT3gtJD2Y65kdnB1Uev3h"),sa=new h("CDSr3ssLcRB6XYPJwAfFt18MZvEZp4LjHcvzBVZ45duo"),aa=new h("CAMMCzo5YL8w4VFF8KVHrK22GGUsp5VTaW7grrKgrWqK"),ua=new h("LockrWmn6K5twhz3y9w1dQERbmgSaRkfnTeTKbpofwE"),ca=new h("kN1kEznaF5Xbd8LYuqtEFcxzWSBk5Fv6ygX6SqEGJVy"),ma=new h("CDSr3ssLcRB6XYPJwAfFt18MZvEZp4LjHcvzBVZ45duo"),la=new h("routeUGWgWzqBWFcrCfv8tritsqukccJPu3q5GPP3xS"),da=new h("7YttLkHDoNj9wyDur5pM1ejNaAvT9X4eqaYcHQqtj2G5"),fa=new h("6FJon3QE27qgPVggARueB22hLvoh22VzJpXv4rBEoSLF"),pa=new h("CC12se5To1CdEuw7fDS27B7Geo5jJyL7t5UK2B44NgiH"),ga=new h("9HzJyW1qZsEiSfMUf6L2jo3CcTKAyBmSyKdwQeYisHrC"),ha=new h("DropEU8AvevN3UrXWXTMuz3rqnMczQVNjq3kcSdW2SQi"),ba=new h("CPMMoo8L3F4NbTegBCKVNunggL7H1ZpdTHKxQB5qKP1C"),ya=new h("GpMZbSM2GgvTKHJirzeGfMFoaZ8UR2X7F4v8vHTvxFbL"),wa=new h("DNXgeM9EiiaAbaWvwjHj9fQQLAX5ZsfHyvmYUNRAdNC8"),Ta=new h("LockrWmn6K5twhz3y9w1dQERbmgSaRkfnTeTKbpofwE"),xa=new h("3f7GcQFG397GAaEnv51zR6tsTVihYRydnydDD1cXekxH"),Aa=new h("LanMV9sAd7wArD4vJFi2qDdfnVhFxYSUg6eADduJ3uj"),Pa=new h("WLHv2UAZm6z4KyaaELi5pjdbJh6RESMva1Rnn8pJVVh"),ka=new h("DRay6fNdQ5J82H7xV6uq2aV3mNrUZ1J4PgSKsWgptcm6"),Ba=new h("5xqNaZXX5eUi4p5HU4oz9i5QnwRNT2y6oN7yyn4qENeq"),Ia=new h("4Bu96XjU84XjPDSpveTVf6LYGCkfW5FK7SNkREWcEfV4"),Na=new h("6s1xP3hpbAfFoNtUNF8mfHsjr2Bd97JxFJRWLbL6aHuX");var Sa={OPEN_BOOK_PROGRAM:new h("EoTcMgcDRTJVZDMZWBoU6rhYHZfkNTVEAfz3uUJRcYGj"),SERUM_PROGRAM_ID_V3:new h("Ray1111111111111111111111111111111111111111"),AMM_V4:new h("DRaya7Kj3aMWQSy19kSjvmuwq9docCHofyP9kanQGaav"),AMM_STABLE:new h("DRayDdXc1NZQ9C3hRWmoSf8zK4iapgMnjdNZWrfwsP8m"),CLMM_PROGRAM_ID:new h("DRayAUgENGQBKVaX8owNhgzkEDyoHTGVEGHVJT1E9pfH"),CLMM_LOCK_PROGRAM_ID:new h("DRay25Usp3YJAi7beckgpGUC7mGJ2cR1AVPxhYfwVCUX"),CLMM_LOCK_AUTH_ID:new h("6Aoh8h2Lw2m5UGxYR8AdAL87jTWYeKoxM52mJRzfYwN"),CREATE_CPMM_POOL_PROGRAM:new h("DRaycpLY18LhpbydsBWbVJtxpNv9oXPgjRSfpF2bWpYb"),CREATE_CPMM_POOL_AUTH:new h("CXniRufdq5xL8t8jZAPxsPZDpuudwuJSPWnbcD5Y5Nxq"),CREATE_CPMM_POOL_FEE_ACC:new h("3oE58BKVt8KuYkGxx8zBojugnymWmBiyafWgMrnb6eYy"),LOCK_CPMM_PROGRAM:new h("DRay25Usp3YJAi7beckgpGUC7mGJ2cR1AVPxhYfwVCUX"),LOCK_CPMM_AUTH:new h("7qWVV8UY2bRJfDLP4s37YzBPKUkVB46DStYJBpYbQzu3"),UTIL1216:h.default,Router:new h("DRaybByLpbUL57LJARs3j8BitTxVfzBg351EaMr5UTCd"),FARM_PROGRAM_ID_V3:new h("DRayWyrLmEW5KEeqs8kdTMMaBabapqagaBC7KWpGtJeZ"),FARM_PROGRAM_ID_V4:new h("Ray1111111111111111111111111111111111111111"),FARM_PROGRAM_ID_V5:new h("DRayiCGSZgku1GTK6rXD6mVDdingXy6APAH1R6R5L2LC"),FARM_PROGRAM_ID_V6:new h("DRayzbYakXs45ELHkzH6vC3fuhQqTAnv5A68gdFuvZyZ"),LAUNCHPAD_PROGRAM:new h("DRay6fNdQ5J82H7xV6uq2aV3mNrUZ1J4PgSKsWgptcm6"),LAUNCHPAD_AUTH:new h("5xqNaZXX5eUi4p5HU4oz9i5QnwRNT2y6oN7yyn4qENeq"),LAUNCHPAD_PLATFORM:new h("2Jx4KTDrVSdWNazuGpcA8n3ZLTRGGBDxAWhuKe2Xcj2a"),LAUNCHPAD_CONFIG:new h("7ZR4zD7PYfY2XxoG1Gxcy2EgEeGYrpxrwzPuwdUBssEt"),FEE_DESTINATION_ID:new h("9y8ENuuZ3b19quffx9hQvRVygG5ky6snHfRvGpuSfeJy"),MODEL_DATA_PUBKEY:new h("Ray1111111111111111111111111111111111111111")};import re from"bn.js";var Me=1e4;function ie(t,e,n,r){if(e===void 0)return{amount:t,fee:void 0,expirationTime:void 0};let i=ce(oe({},e),{olderTransferFee:{epoch:BigInt(e.olderTransferFee.epoch),maximumFee:BigInt(e.olderTransferFee.maximumFee),transferFeeBasisPoints:e.olderTransferFee.transferFeeBasisPoints},newerTransferFee:{epoch:BigInt(e.newerTransferFee.epoch),maximumFee:BigInt(e.newerTransferFee.maximumFee),transferFeeBasisPoints:e.newerTransferFee.transferFeeBasisPoints}}),o=n.epoch<i.newerTransferFee.epoch?i.olderTransferFee:i.newerTransferFee,s=new re(o.maximumFee.toString()),a=n.epoch<i.newerTransferFee.epoch?(Number(i.newerTransferFee.epoch)*n.slotsInEpoch-n.absoluteSlot)*400/1e3:void 0;if(r)if(o.transferFeeBasisPoints===Me){let c=new re(o.maximumFee.toString());return{amount:t.add(c),fee:c,expirationTime:a}}else{let c=Tt(t.mul(new re(Me)),new re(Me-o.transferFeeBasisPoints)),u=new re(o.maximumFee.toString()),m=c.sub(t).gt(u)?t.add(u):c,l=Tt(m.mul(new re(o.transferFeeBasisPoints)),new re(Me)),d=l.gt(s)?s:l;return{amount:m,fee:d,expirationTime:a}}else{let c=Tt(t.mul(new re(o.transferFeeBasisPoints)),new re(Me)),u=c.gt(s)?s:c;return{amount:t,fee:u,expirationTime:a}}}function ve(t,e){return t===void 0?e:e===void 0?t:Math.min(t,e)}function Tt(t,e){let{div:n,mod:r}=t.divmod(e);return r.gt(new re(0))?n.add(new re(1)):n}import{PublicKey as Fa,AddressLookupTableAccount as Ma}from"@solana/web3.js";import{PublicKey as Qa,sendAndConfirmTransaction as $a,SystemProgram as nu,Transaction as ru,TransactionMessage as ou,VersionedTransaction as su}from"@solana/web3.js";import uu from"axios";import{PublicKey as gu}from"@solana/web3.js";import bu from"bn.js";import Or from"bn.js";var Au=new Or(1e6);import J from"bn.js";var Q=new J(0),be=new J(1),on=new J(-1),$=new J(1).shln(64),Qe=new J(1).shln(128),xt=$.sub(be),De=64,sn=Qe.subn(1),Ae=-443636,Be=-Ae,At=new J("4295048016"),Pt=new J("79226673521066979257578248091"),Wu=new J("4295048017"),Xu=new J("79226673521066979257578248090"),an=16,un="59543866431248",cn="184467440737095516",mn="15793534762490258745",Kr=new J(10).pow(new J(6));var Hu=new J("18446744073700000000");import B from"bn.js";var $u=Buffer.from("amm_config","utf8"),ec=Buffer.from("pool","utf8"),tc=Buffer.from("pool_vault","utf8"),nc=Buffer.from("pool_reward_vault","utf8"),rc=Buffer.from("position","utf8"),ic=Buffer.from("tick_array","utf8"),oc=Buffer.from("operation","utf8"),sc=Buffer.from("pool_tick_array_bitmap_extension","utf8"),ac=Buffer.from("observation","utf8");var uc=Buffer.from("locked_position","utf8");var cc=Buffer.from("support_mint","utf8");import{PublicKey as $m}from"@solana/web3.js";import{TOKEN_2022_PROGRAM_ID as tl}from"@solana/spl-token";import rl from"bn.js";import{PublicKey as Zr}from"@solana/web3.js";import pn,{isBN as gn}from"bn.js";import{bits as dc,BitStructure as fc,blob as qr,Blob as pc,cstr as gc,f32 as hc,f32be as bc,f64 as yc,f64be as wc,greedy as Tc,Layout as Gr,ns64 as xc,ns64be as Ac,nu64 as Pc,nu64be as kc,offset as Bc,s16 as Ic,s16be as Nc,s24 as Sc,s24be as Cc,s32 as Vr,s32be as Lc,s40 as Rc,s40be as Ec,s48 as _c,s48be as Fc,s8 as Mc,seq as Ur,struct as vc,Structure as Wr,u16 as Xr,u16be as Dc,u24 as Oc,u24be as Kc,u32 as qc,u32be as Gc,u40 as Vc,u40be as Uc,u48 as Wc,u48be as Xc,u8 as Hr,UInt as zr,union as Hc,Union as zc,unionLayoutDiscriminator as Zc,utf8 as Yc}from"@solana/buffer-layout";var kt=Gr,ln=Wr;var Bt=zr;var dn=Hr,Oe=Xr;var ye=Vr;var fn=Ur;var Y=qr;var Ie=class extends kt{constructor(n,r,i){super(n,i);this.blob=Y(n),this.signed=r}decode(n,r=0){let i=new pn(this.blob.decode(n,r),10,"le");return this.signed?i.fromTwos(this.span*8).clone():i}encode(n,r,i=0){return typeof n=="number"&&(n=new pn(n)),this.signed&&(n=n.toTwos(this.span*8)),this.blob.encode(n.toArrayLike(Buffer,"le",this.span),r,i)}};function Z(t){return new Bt(1,t)}function Ne(t){return new Bt(4,t)}function k(t){return new Ie(8,!1,t)}function F(t){return new Ie(16,!1,t)}function hn(t){return new Ie(8,!0,t)}function bn(t){return new Ie(16,!0,t)}var $e=class extends kt{constructor(n,r,i,o){super(n.span,o);this.layout=n,this.decoder=r,this.encoder=i}decode(n,r){return this.decoder(this.layout.decode(n,r))}encode(n,r,i){return this.layout.encode(this.encoder(n),r,i)}getSpan(n,r){return this.layout.getSpan(n,r)}};function S(t){return new $e(Y(32),e=>new Zr(e),e=>e.toBuffer(),t)}function yn(t){return new $e(dn(),Yr,jr,t)}function Yr(t){if(t===0)return!1;if(t===1)return!0;throw new Error("Invalid bool: "+t)}function jr(t){return t?1:0}var It=class extends ln{decode(e,n){return super.decode(e,n)}};function X(t,e,n){return new It(t,e,n)}function _(t,e,n){let r,i=typeof e=="number"?e:gn(e)?e.toNumber():new Proxy(e,{get(o,s){if(!r){let a=Reflect.get(o,"count");r=gn(a)?a.toNumber():a,Reflect.set(o,"count",r)}return Reflect.get(o,s)},set(o,s,a){return s==="count"&&(r=a),Reflect.set(o,s,a)}});return fn(t,i,n)}import bm from"bn.js";var et=60;var Lt=14;var Om=X([Y(8),Z("bump"),Oe("index"),S(""),Ne("protocolFeeRate"),Ne("tradeFeeRate"),Oe("tickSpacing"),_(k(),8,"")]),Qr=X([Ne("blockTimestamp"),hn("tickCumulative"),_(k(),4)]),Km=X([Y(8),yn("initialized"),k("recentEpoch"),Oe("observationIndex"),S("poolId"),_(Qr,100,"observations"),_(k(),4)]),$r=X([Z("rewardState"),k("openTime"),k("endTime"),k("lastUpdateTime"),F("emissionsPerSecondX64"),k("rewardTotalEmissioned"),k("rewardClaimed"),S("tokenMint"),S("tokenVault"),S("creator"),F("rewardGrowthGlobalX64")]),ei=X([Y(8),Z("bump"),S("ammConfig"),S("creator"),S("mintA"),S("mintB"),S("vaultA"),S("vaultB"),S("observationId"),Z("mintDecimalsA"),Z("mintDecimalsB"),Oe("tickSpacing"),F("liquidity"),F("sqrtPriceX64"),ye("tickCurrent"),Ne(),F("feeGrowthGlobalX64A"),F("feeGrowthGlobalX64B"),k("protocolFeesTokenA"),k("protocolFeesTokenB"),F("swapInAmountTokenA"),F("swapOutAmountTokenB"),F("swapInAmountTokenB"),F("swapOutAmountTokenA"),Z("status"),_(Z(),7,""),_($r,3,"rewardInfos"),_(k(),16,"tickArrayBitmap"),k("totalFeesTokenA"),k("totalFeesClaimedTokenA"),k("totalFeesTokenB"),k("totalFeesClaimedTokenB"),k("fundFeesTokenA"),k("fundFeesTokenB"),k("startTime"),_(k(),15*4-3,"padding")]),ti=X([F("growthInsideLastX64"),k("rewardAmountOwed")]),ni=X([Y(8),Z("bump"),S("nftMint"),S("poolId"),ye("tickLower"),ye("tickUpper"),F("liquidity"),F("feeGrowthInsideLastX64A"),F("feeGrowthInsideLastX64B"),k("tokenFeesOwedA"),k("tokenFeesOwedB"),_(ti,3,"rewardInfos"),_(k(),8,"")]),qm=X([Y(8),Z("bump"),S("poolId"),ye("tickLowerIndex"),ye("tickUpperIndex"),F("liquidity"),F("feeGrowthInsideLastX64A"),F("feeGrowthInsideLastX64B"),k("tokenFeesOwedA"),k("tokenFeesOwedB"),_(F(),3,"rewardGrowthInside"),_(k(),8,"")]),ri=X([ye("tick"),bn("liquidityNet"),F("liquidityGross"),F("feeGrowthOutsideX64A"),F("feeGrowthOutsideX64B"),_(F(),3,"rewardGrowthsOutsideX64"),_(Ne(),13,"")]),wn=X([Y(8),S("poolId"),ye("startTickIndex"),_(ri,et,"ticks"),Z("initializedTickCount"),_(Z(),115,"")]),Gm=X([Y(329),_(S(),100,"whitelistMints")]),ii=X([Y(8),S("poolId"),_(_(k(),8),Lt,"positiveTickArrayBitmap"),_(_(k(),8),Lt,"negativeTickArrayBitmap")]),Vm=X([k(),Z("bump"),S("owner"),S("poolId"),S("positionId"),S("nftAccount"),_(k(),8)]),Um=X([Y(8),Z("bump"),S("lockOwner"),S("poolId"),S("positionId"),S("nftAccount"),S("lockNftMint"),k("recentEpoch"),_(k(),8)]);var P=class{static mulDivRoundingUp(e,n,r){let i=e.mul(n),o=i.div(r);return i.mod(r).eq(Q)||(o=o.add(be)),o}static mulDivFloor(e,n,r){if(r.eq(Q))throw new Error("division by 0");return e.mul(n).div(r)}static mulDivCeil(e,n,r){if(r.eq(Q))throw new Error("division by 0");return e.mul(n).add(r.sub(be)).div(r)}static x64ToDecimal(e,n){return new O(e.toString()).div(O.pow(2,64)).toDecimalPlaces(n)}static decimalToX64(e){return new B(e.mul(O.pow(2,64)).floor().toFixed())}static wrappingSubU128(e,n){return e.add(Qe).sub(n).mod(Qe)}};function K(t,e){return Et(t.mul(e),64,256)}function oi(t,e,n){let r=t.toTwos(n).shln(e);return r.imaskn(n+1),r.fromTwos(n)}function Et(t,e,n){let r=t.toTwos(n).shrn(e);return r.imaskn(n-e+1),r.fromTwos(n-e)}var H=class{static sqrtPriceX64ToPrice(e,n,r){return P.x64ToDecimal(e).pow(2).mul(O.pow(10,n-r))}static priceToSqrtPriceX64(e,n,r){return P.decimalToX64(e.mul(O.pow(10,r-n)).sqrt())}static getNextSqrtPriceX64FromInput(e,n,r,i){if(!e.gt(Q))throw new Error("sqrtPriceX64 must greater than 0");if(!n.gt(Q))throw new Error("liquidity must greater than 0");return i?this.getNextSqrtPriceFromTokenAmountARoundingUp(e,n,r,!0):this.getNextSqrtPriceFromTokenAmountBRoundingDown(e,n,r,!0)}static getNextSqrtPriceX64FromOutput(e,n,r,i){if(!e.gt(Q))throw new Error("sqrtPriceX64 must greater than 0");if(!n.gt(Q))throw new Error("liquidity must greater than 0");return i?this.getNextSqrtPriceFromTokenAmountBRoundingDown(e,n,r,!1):this.getNextSqrtPriceFromTokenAmountARoundingUp(e,n,r,!1)}static getNextSqrtPriceFromTokenAmountARoundingUp(e,n,r,i){if(r.eq(Q))return e;let o=n.shln(De);if(i){let s=o,a=o.add(r.mul(e));return a.gte(s)?P.mulDivCeil(s,e,a):P.mulDivRoundingUp(s,be,s.div(e).add(r))}else{let s=r.mul(e);if(!o.gt(s))throw new Error("getNextSqrtPriceFromTokenAmountARoundingUp,liquidityLeftShift must gt amountMulSqrtPrice");let a=o.sub(s);return P.mulDivCeil(o,e,a)}}static getNextSqrtPriceFromTokenAmountBRoundingDown(e,n,r,i){let o=r.shln(De);if(i)return e.add(o.div(n));{let s=P.mulDivRoundingUp(o,be,n);if(!e.gt(s))throw new Error("getNextSqrtPriceFromTokenAmountBRoundingDown sqrtPriceX64 must gt amountDivLiquidity");return e.sub(s)}}static getSqrtPriceX64FromTick(e){if(!Number.isInteger(e))throw new Error("tick must be integer");if(e<Ae||e>Be)throw new Error("tick must be in MIN_TICK and MAX_TICK");let n=e<0?e*-1:e,r=(n&1)!=0?new B("18445821805675395072"):new B("18446744073709551616");return(n&2)!=0&&(r=K(r,new B("18444899583751176192"))),(n&4)!=0&&(r=K(r,new B("18443055278223355904"))),(n&8)!=0&&(r=K(r,new B("18439367220385607680"))),(n&16)!=0&&(r=K(r,new B("18431993317065453568"))),(n&32)!=0&&(r=K(r,new B("18417254355718170624"))),(n&64)!=0&&(r=K(r,new B("18387811781193609216"))),(n&128)!=0&&(r=K(r,new B("18329067761203558400"))),(n&256)!=0&&(r=K(r,new B("18212142134806163456"))),(n&512)!=0&&(r=K(r,new B("17980523815641700352"))),(n&1024)!=0&&(r=K(r,new B("17526086738831433728"))),(n&2048)!=0&&(r=K(r,new B("16651378430235570176"))),(n&4096)!=0&&(r=K(r,new B("15030750278694412288"))),(n&8192)!=0&&(r=K(r,new B("12247334978884435968"))),(n&16384)!=0&&(r=K(r,new B("8131365268886854656"))),(n&32768)!=0&&(r=K(r,new B("3584323654725218816"))),(n&65536)!=0&&(r=K(r,new B("696457651848324352"))),(n&131072)!=0&&(r=K(r,new B("26294789957507116"))),(n&262144)!=0&&(r=K(r,new B("37481735321082"))),e>0&&(r=sn.div(r)),r}static getTickFromPrice(e,n,r){return H.getTickFromSqrtPriceX64(H.priceToSqrtPriceX64(e,n,r))}static getTickFromSqrtPriceX64(e){if(e.gt(Pt)||e.lt(At))throw new Error("Provided sqrtPrice is not within the supported sqrtPrice range.");let n=e.bitLength()-1,r=new B(n-64),i=oi(r,32,128),o=new B("8000000000000000","hex"),s=0,a=new B(0),c=n>=64?e.shrn(n-63):e.shln(63-n);for(;o.gt(new B(0))&&s<an;){c=c.mul(c);let T=c.shrn(127);c=c.shrn(63+T.toNumber()),a=a.add(o.mul(T)),o=o.shrn(1),s+=1}let u=a.shrn(32),l=i.add(u).mul(new B(un)),d=Et(l.sub(new B(cn)),64,128).toNumber(),p=Et(l.add(new B(mn)),64,128).toNumber();return d==p?d:H.getSqrtPriceX64FromTick(p).lte(e)?p:d}};var W=class{static addDelta(e,n){return e.add(n)}static getTokenAmountAFromLiquidity(e,n,r,i){if(e.gt(n)&&([e,n]=[n,e]),!e.gt(Q))throw new Error("sqrtPriceX64A must greater than 0");let o=r.ushln(De),s=n.sub(e);return i?P.mulDivRoundingUp(P.mulDivCeil(o,s,n),be,e):P.mulDivFloor(o,s,n).div(e)}static getTokenAmountBFromLiquidity(e,n,r,i){if(e.gt(n)&&([e,n]=[n,e]),!e.gt(Q))throw new Error("sqrtPriceX64A must greater than 0");return i?P.mulDivCeil(r,n.sub(e),$):P.mulDivFloor(r,n.sub(e),$)}static getLiquidityFromTokenAmountA(e,n,r,i){e.gt(n)&&([e,n]=[n,e]);let o=r.mul(e).mul(n),s=n.sub(e),a=o.div(s);return i?P.mulDivRoundingUp(a,be,xt):a.shrn(De)}static getLiquidityFromTokenAmountB(e,n,r){return e.gt(n)&&([e,n]=[n,e]),P.mulDivFloor(r,xt,n.sub(e))}static getLiquidityFromTokenAmounts(e,n,r,i,o){if(n.gt(r)&&([n,r]=[r,n]),e.lte(n))return W.getLiquidityFromTokenAmountA(n,r,i,!1);if(e.lt(r)){let s=W.getLiquidityFromTokenAmountA(e,r,i,!1),a=W.getLiquidityFromTokenAmountB(n,e,o);return s.lt(a)?s:a}else return W.getLiquidityFromTokenAmountB(n,r,o)}static getAmountsFromLiquidity(e,n,r,i,o){if(n.gt(r)&&([n,r]=[r,n]),e.lte(n))return{amountA:W.getTokenAmountAFromLiquidity(n,r,i,o),amountB:new B(0)};if(e.lt(r)){let s=W.getTokenAmountAFromLiquidity(e,r,i,o),a=W.getTokenAmountBFromLiquidity(n,e,i,o);return{amountA:s,amountB:a}}else return{amountA:new B(0),amountB:W.getTokenAmountBFromLiquidity(n,r,i,o)}}static getAmountsFromLiquidityWithSlippage(e,n,r,i,o,s,a){let{amountA:c,amountB:u}=W.getAmountsFromLiquidity(e,n,r,i,s),m=o?1+a:1-a,l=new B(new O(c.toString()).mul(m).toFixed(0)),d=new B(new O(u.toString()).mul(m).toFixed(0));return{amountSlippageA:l,amountSlippageB:d}}static getAmountsOutFromLiquidity({poolInfo:e,tickLower:n,tickUpper:r,liquidity:i,slippage:o,add:s,epochInfo:a,amountAddFee:c}){var q,I,v,we;let u=H.priceToSqrtPriceX64(new O(e.price),e.mintA.decimals,e.mintB.decimals),m=H.getSqrtPriceX64FromTick(n),l=H.getSqrtPriceX64FromTick(r),d=s?1+o:1-o,p=W.getAmountsFromLiquidity(u,m,l,i,s),[T,y]=[ie(p.amountA,(q=e.mintA.extensions)==null?void 0:q.feeConfig,a,c),ie(p.amountB,(I=e.mintB.extensions)==null?void 0:I.feeConfig,a,c)],[M,N]=[ie(new B(new O(p.amountA.toString()).mul(d).toFixed(0)),(v=e.mintA.extensions)==null?void 0:v.feeConfig,a,c),ie(new B(new O(p.amountB.toString()).mul(d).toFixed(0)),(we=e.mintB.extensions)==null?void 0:we.feeConfig,a,c)];return{liquidity:i,amountA:T,amountB:y,amountSlippageA:M,amountSlippageB:N,expirationTime:ve(T.expirationTime,y.expirationTime)}}};var Rt=class{static getfeeGrowthInside(e,n,r){let i=new ae(0),o=new ae(0);e.tickCurrent>=n.tick?(i=n.feeGrowthOutsideX64A,o=n.feeGrowthOutsideX64B):(i=e.feeGrowthGlobalX64A.sub(n.feeGrowthOutsideX64A),o=e.feeGrowthGlobalX64B.sub(n.feeGrowthOutsideX64B));let s=new ae(0),a=new ae(0);e.tickCurrent<r.tick?(s=r.feeGrowthOutsideX64A,a=r.feeGrowthOutsideX64B):(s=e.feeGrowthGlobalX64A.sub(r.feeGrowthOutsideX64A),a=e.feeGrowthGlobalX64B.sub(r.feeGrowthOutsideX64B));let c=P.wrappingSubU128(P.wrappingSubU128(e.feeGrowthGlobalX64A,i),s),u=P.wrappingSubU128(P.wrappingSubU128(e.feeGrowthGlobalX64B,o),a);return{feeGrowthInsideX64A:c,feeGrowthInsideBX64:u}}static GetPositionFees(e,n,r,i){let{feeGrowthInsideX64A:o,feeGrowthInsideBX64:s}=this.getfeeGrowthInside(e,r,i),a=P.mulDivFloor(P.wrappingSubU128(o,n.feeGrowthInsideLastX64A),n.liquidity,$),c=n.tokenFeesOwedA.add(a),u=P.mulDivFloor(P.wrappingSubU128(s,n.feeGrowthInsideLastX64B),n.liquidity,$),m=n.tokenFeesOwedB.add(u);return{tokenFeeAmountA:c,tokenFeeAmountB:m}}static GetPositionFeesV2(e,n,r,i){let{feeGrowthInsideX64A:o,feeGrowthInsideBX64:s}=this.getfeeGrowthInside(e,r,i),a=P.mulDivFloor(P.wrappingSubU128(o,n.feeGrowthInsideLastX64A),n.liquidity,$),c=n.tokenFeesOwedA.add(a),u=P.mulDivFloor(P.wrappingSubU128(s,n.feeGrowthInsideLastX64B),n.liquidity,$),m=n.tokenFeesOwedB.add(u);return{tokenFeeAmountA:c,tokenFeeAmountB:m}}static GetPositionRewardsV2(e,n,r,i){let o=[],s=this.getRewardGrowthInsideV2(e.tickCurrent,r,i,e.rewardInfos);for(let a=0;a<s.length;a++){let c=s[a],u=n.rewardInfos[a],m=P.wrappingSubU128(c,u.growthInsideLastX64),l=P.mulDivFloor(m,n.liquidity,$),d=u.rewardAmountOwed.add(l);o.push(d)}return o}static GetPositionRewards(e,n,r,i){let o=[],s=this.getRewardGrowthInside(e.tickCurrent,r,i,e.rewardInfos);for(let a=0;a<s.length;a++){let c=s[a],u=n.rewardInfos[a],m=P.wrappingSubU128(c,u.growthInsideLastX64),l=P.mulDivFloor(m,n.liquidity,$),d=u.rewardAmountOwed.add(l);o.push(d)}return o}static getRewardGrowthInside(e,n,r,i){let o=[];for(let s=0;s<i.length;s++){let a=new ae(0);n.liquidityGross.eqn(0)?a=i[s].rewardGrowthGlobalX64:e<n.tick?a=i[s].rewardGrowthGlobalX64.sub(n.rewardGrowthsOutsideX64[s]):a=n.rewardGrowthsOutsideX64[s];let c=new ae(0);r.liquidityGross.eqn(0)||(e<r.tick?c=r.rewardGrowthsOutsideX64[s]:c=i[s].rewardGrowthGlobalX64.sub(r.rewardGrowthsOutsideX64[s])),o.push(P.wrappingSubU128(P.wrappingSubU128(i[s].rewardGrowthGlobalX64,a),c))}return o}static getRewardGrowthInsideV2(e,n,r,i){let o=[];for(let s=0;s<i.length;s++){let a=new ae(0);n.liquidityGross.eqn(0)?a=i[s].rewardGrowthGlobalX64:e<n.tick?a=i[s].rewardGrowthGlobalX64.sub(n.rewardGrowthsOutsideX64[s]):a=n.rewardGrowthsOutsideX64[s];let c=new ae(0);r.liquidityGross.eqn(0)||(e<r.tick?c=r.rewardGrowthsOutsideX64[s]:c=i[s].rewardGrowthGlobalX64.sub(r.rewardGrowthsOutsideX64[s])),o.push(P.wrappingSubU128(P.wrappingSubU128(i[s].rewardGrowthGlobalX64,a),c))}return o}static getAmountsFromLiquidity({poolInfo:e,ownerPosition:n,liquidity:r,slippage:i,add:o,epochInfo:s}){var M,N,q,I;let a=H.priceToSqrtPriceX64(new O(e.price),e.mintA.decimals,e.mintB.decimals),c=H.getSqrtPriceX64FromTick(n.tickLower),u=H.getSqrtPriceX64FromTick(n.tickUpper),m=o?1+i:1-i,l=W.getAmountsFromLiquidity(a,c,u,r,o),[d,p]=[ie(l.amountA,(M=e.mintA.extensions)==null?void 0:M.feeConfig,s,!0),ie(l.amountB,(N=e.mintB.extensions)==null?void 0:N.feeConfig,s,!0)],[T,y]=[ie(new ae(new O(l.amountA.toString()).mul(m).toFixed(0)),(q=e.mintA.extensions)==null?void 0:q.feeConfig,s,!0),ie(new ae(new O(l.amountB.toString()).mul(m).toFixed(0)),(I=e.mintB.extensions)==null?void 0:I.feeConfig,s,!0)];return{liquidity:r,amountA:d,amountB:p,amountSlippageA:T,amountSlippageB:y,expirationTime:ve(d.expirationTime,p.expirationTime)}}};export{Rt as PositionUtils};
//# sourceMappingURL=position.mjs.map